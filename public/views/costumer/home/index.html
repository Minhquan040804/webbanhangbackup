<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Trang chủ</title>
    <style>
        /* CSS sẽ được kế thừa từ styles.css, nhưng có thể thêm style cụ thể nếu cần */
        .category-1, .category-2, .category-3 {
            margin-bottom: 40px;
        }

        .category-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            border-bottom: 2px solid #007bff;
            display: inline-block;
        }

        .product {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .info-product {
            text-align: center;
        }

        .info-product a {
            text-decoration: none;
            color: #333;
        }

        .info-product img {
            max-width: 100%;
            height: auto;
        }

        .name-product {
            font-size: 16px;
            margin: 10px 0;
        }

        .price-product {
            color: #e74c3c;
            font-weight: bold;
        }

        .more {
            display: block;
            text-align: center;
            margin-top: 20px;
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
        }

        .more:hover {
            text-decoration: underline;
        }

        .space {
            height: 20px;
        }

        .post-container {
            display: flex;
            gap: 20px;
        }

        .owl-item {
            flex: 1;
        }

        .review-item {
            border: 1px solid #ddd;
            padding: 10px;
        }

        .post-img img {
            width: 100%;
            height: auto;
        }

        .blog_deatail {
            padding: 10px;
        }

        .review a {
            text-decoration: none;
            color: #333;
            font-weight: bold;
        }

        .review a:hover {
            color: #007bff;
        }

        .info {
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="category-1">
        <div class="category-header">SÁCH MỚI</div>
        <div class="product" id="new-products">
            <!-- Dữ liệu sản phẩm sẽ được tải bằng JS -->
        </div>
        <a href="/products" class="more">Xem Thêm</a>
        <div class="space"></div>
    </div>
    <div class="category-2">
        <div class="category-header">SÁCH BÁN CHẠY</div>
        <div class="product" id="best-sellers">
            <!-- Dữ liệu sản phẩm sẽ được tải bằng JS -->
        </div>
        <a href="/products" class="more">Xem Thêm</a>
        <div class="space"></div>
    </div>
    <div class="category-3">
        <div class="category-header">BÀI VIẾT MỚI</div>
        <div class="post-container" id="new-posts">
            <!-- Dữ liệu tin tức sẽ được tải bằng JS -->
        </div>
    </div>

    <script>
        // Tải danh sách sản phẩm mới
        function loadNewProducts() {
            fetch('/products')
                .then(response => response.json())
                .then(products => {
                    products.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    const newProducts = products.slice(0, 10);
                    const productList = document.getElementById('new-products');
                    productList.innerHTML = newProducts.map(product => `
                        <div class="info-product">
                            <a href="/products/${product._id}">
                                <img class="img-product" src="${product.image || 'https://via.placeholder.com/150'}" alt="${product.title}">
                                <h3 class="name-product">${product.title}</h3>
                                <p class="price-product">${product.price} VNĐ</p>
                            </a>
                        </div>
                    `).join('');
                })
                .catch(error => {
                    document.getElementById('new-products').innerHTML = `<p>Lỗi: ${error.message}</p>`;
                });
        }

        // Tải danh sách sản phẩm bán chạy
        function loadBestSellers() {
            fetch('/products')
                .then(response => response.json())
                .then(products => {
                    products.sort((a, b) => a.quantity - b.quantity);
                    const bestSellers = products.slice(0, 10);
                    const productList = document.getElementById('best-sellers');
                    productList.innerHTML = bestSellers.map(product => `
                        <div class="info-product">
                            <a href="/products/${product._id}">
                                <img class="img-product" src="${product.image || 'https://via.placeholder.com/150'}" alt="${product.title}">
                                <h3 class="name-product">${product.title}</h3>
                                <p class="price-product">${product.price} VNĐ</p>
                            </a>
                        </div>
                    `).join('');
                })
                .catch(error => {
                    document.getElementById('best-sellers').innerHTML = `<p>Lỗi: ${error.message}</p>`;
                });
        }

        // Tải danh sách bài viết mới
        function loadNewPosts() {
            fetch('/news')
                .then(response => response.json())
                .then(news => {
                    news.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    const recentNews = news.slice(0, 3);
                    const newsList = document.getElementById('new-posts');
                    newsList.innerHTML = recentNews.map(item => `
                        <div class="owl-item">
                            <div class="review-item">
                                <div class="post">
                                    <div class="post-img">
                                        <a href="/news/${item._id}">
                                            <img src="${item.image || 'https://via.placeholder.com/150'}" alt="${item.title}">
                                        </a>
                                    </div>
                                    <div class="blog_deatail">
                                        <p class="review">
                                            <a href="/news/${item._id}">${item.title}</a>
                                        </p>
                                        <div class="info">${item.description}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                })
                .catch(error => {
                    document.getElementById('new-posts').innerHTML = `<p>Lỗi: ${error.message}</p>`;
                });
        }

        // Tải nội dung khi trang load
        window.onload = () => {
            loadNewProducts();
            loadBestSellers();
            loadNewPosts();
        };
    </script>
</body>
</html>